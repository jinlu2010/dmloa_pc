{"remainingRequest":"D:\\HBuilderProjects\\DML_OA\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\HBuilderProjects\\DML_OA\\src\\pages\\login\\Login.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\HBuilderProjects\\DML_OA\\src\\pages\\login\\Login.vue","mtime":1617947025907},{"path":"D:\\HBuilderProjects\\DML_OA\\node_modules\\css-loader\\index.js","mtime":1615258078741},{"path":"D:\\HBuilderProjects\\DML_OA\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1615258095783},{"path":"D:\\HBuilderProjects\\DML_OA\\node_modules\\postcss-loader\\src\\index.js","mtime":1615258097227},{"path":"D:\\HBuilderProjects\\DML_OA\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615258085839},{"path":"D:\\HBuilderProjects\\DML_OA\\node_modules\\vue-loader\\lib\\index.js","mtime":1615258095774}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nbody {\n\tbackground-color: #004343;\n}\n.verification .el-input{\n\twidth:138px;\n\tmargin-right: 10px;\n}\n.verification .el-button{\n}\n",{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/pages/login","sourcesContent":["<template>\r\n\t<div id=\"login\">\r\n\t\t<h1>段马乐OA管理后台</h1>\r\n\t\t<div class=\"login-layout\">\r\n\t\t\t<el-tabs v-model=\"activeName\" @tab-click=\"handleClick\">\r\n\t\t\t\t<el-tab-pane label=\"密码登录\" name=\"first\">\r\n\t\t\t\t\t<el-form :model=\"loginForm\" status-icon ref=\"loginForm\" label-width=\"100px\"\r\n\t\t\t\t\t\tclass=\"demo-ruleForm\" :rules=\"rules\">\r\n\t\t\t\t\t\t<el-form-item label=\"管理员账户\" prop=\"adminaccount\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"loginForm.adminaccount\"></el-input>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t<el-form-item label=\"密码\" prop=\"password\">\r\n\t\t\t\t\t\t\t<el-input type=\"password\" v-model=\"loginForm.password\"></el-input>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"LoginPwd\">登录</el-button>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"onRegister\">注册</el-button>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</el-form>\r\n\t\t\t\t</el-tab-pane>\r\n\t\t\t\t<el-tab-pane label=\"短信登录\" name=\"second\">\r\n\t\t\t\t\t<el-form :model=\"loginForm\" status-icon ref=\"loginForm\" label-width=\"100px\"\r\n\t\t\t\t\t\tclass=\"demo-ruleForm\" :rules=\"rules\">\r\n\t\t\t\t\t\t<el-form-item label=\"管理员手机\" prop=\"adminphone\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"loginForm.adminphone\"></el-input>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t<el-form-item label=\"短信验证码\" prop=\"smscode\" class=\"verification\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"loginForm.smscode\"></el-input>\r\n\t\t\t\t\t\t\t<el-button @click=\"getCode\">{{valiBtn}}</el-button>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"onSubmit('loginForm')\">登录</el-button>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"onRegister\">注册</el-button>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</el-form>\r\n\t\t\t\t</el-tab-pane>\r\n\t\t\t</el-tabs>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport axios from 'axios'\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\tvar checkPhone = (rule, value, callback) => {\r\n\t\t\t\tif (!value) {\r\n\t\t\t\t\treturn callback(new Error('手机号码不能为空'));\r\n\t\t\t\t}\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tif (value.length < 11) {\r\n\t\t\t\t\t\tcallback(new Error('手机号码不正确'));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1000);\r\n\t\t\t};\r\n\t\t\tvar validatePass = (rule, value, callback) => {\r\n\t\t\t\tif (value === '') {\r\n\t\t\t\t\tcallback(new Error('请输入密码'));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\treturn {\r\n\t\t\t\tactiveName: 'first',\r\n\t\t\t\tloginForm: {\r\n\t\t\t\t\tadminaccount: '',\r\n\t\t\t\t\tpassword: '',\r\n\t\t\t\t\tadminphone: '',\r\n\t\t\t\t\tsmscode: ''\r\n\t\t\t\t},\r\n\t\t\t\trules: {\r\n\t\t\t\t\tadminaccount: [{\r\n\t\t\t\t\t\t\tmessage: '请输入用户名',\r\n\t\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t],\r\n\t\t\t\t\tadminphone: [{\r\n\t\t\t\t\t\tvalidator: checkPhone,\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t}],\r\n\t\t\t\t\tpassword: [{\r\n\t\t\t\t\t\tvalidator: validatePass,\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t}],\r\n\t\t\t\t},\r\n\t\t\t\tvaliBtn:'获取验证码',\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tLoginPwd: function() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tlet data = {\r\n\t\t\t\t\t\"account\": this.loginForm.adminaccount,\r\n\t\t\t\t\t\"password\": this.loginForm.password\r\n\t\t\t\t} // 登录的Schema\r\n\t\t\t\tthis.axios.post('http://47.100.125.167:7080/auth/login', data)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tif (res.data.code == 0) {\r\n\t\t\t\t\t\tlet token = res.data.data.token; // 用户的token\r\n\t\t\t\t\t\t/**\r\n\t\t\t\t\t\t  存储在本地，类似于cookie，后期用于登录验证\r\n\t\t\t\t\t\t  token 会注册在axios的方法中，具体请看 main.js\r\n\t\t\t\t\t\t*/\r\n\t\t\t\t\t\tlocalStorage.setItem('token', token);\r\n\t\t\t\t\t\t// 跳转登录后的页面， 或者弹出成功成功\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthat.message = res.data.message\r\n\t\t\t\t\t\talert(that.message)\r\n\t\t\t\t\t\t// 用户名密码错误， 前端进行处理\r\n\t\t\t\t\t}\r\n\t\t\t\t})\t\r\n\t\t\t},\r\n\t\t\tonSubmit(formName) {  //点击登录 验证手机& 验证码是否符合条件\r\n\t\t\t\tthis.$refs[formName].validate((valid) => {    // 为表单绑定验证功能\r\n\t\t\t\t\tif (valid) {\r\n\t\t\t\t\t\tlet fd = new FormData();\r\n\t\t\t\t        fd.append('phone', this.loginForm.adminphone);\r\n\t\t\t\t        fd.append('sms_type', this.loginForm.smscode);\r\n\t\t\t\t        this.$axios({\r\n\t\t\t\t\t\t\tmethod: 'POST', data: fd, url: 'http://47.100.125.167:7080/auth/sms_code',\r\n\t\t\t\t        }).then(res => {\r\n\t\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\t\tif (res.data.EID == 0) {\r\n\t\t\t\t\t\t\t\tvar token = res.data.Data[0].token;\r\n\t\t\t\t\t\t\t\tlocalStorage.setItem('token',token);\r\n\t\t\t\t\t\t\t\tthis.$message({showClose: true,message: '登录成功',type: 'success'})\r\n\t\t\t\t\t\t\t\tthis.$router.push({path:'/indexx'});\r\n\t\t\t\t            } else {\r\n\t\t\t\t\t\t\t\tthis.$message({showClose: true,message: res.data.Err,type: 'warning'})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t        });\r\n\t\t\t\t    } else {\r\n\t\t\t\t\t\tthis.dialogVisible = true;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t/*onLogin() {\r\n\t\t\t\tlet {adminaccount,password} = this.loginForm;\r\n\t\t\t\tif (adminaccount == 'admin' && password == 'admin') {\r\n\t\t\t\t\tsessionStorage.setItem('username', adminaccount);\r\n\t\t\t\t\tthis.$router.push('/index')\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert('用户名和密码不匹配')\r\n\t\t\t\t}\r\n\t\t\t},*/\r\n\t\t\t\r\n\t\t\tonRegister() {\r\n\t\t\t\tthis.$router.push('/register')\r\n\t\t\t},\r\n\t\t\thandleClick(tab, event) {\r\n\t\t\t\tconsole.log(tab, event);\r\n\t\t\t},\r\n\t\t\t//获取验证码    \r\n\t\t\t//获取验证码 并只验证手机号 是否正确\r\n\t\t\tgetCode(){\r\n\t\t\t   this.$refs['loginForm'].validateField('adminphone', (err) =>{\r\n\t\t\t        if(err){\r\n\t\t\t            console.log('未通过')\r\n\t\t\t            return;\r\n\t\t\t        }else{\r\n\t\t\t            console.log('已通过')\r\n\t\t\t            this.tackBtn();   //验证码倒数60秒\r\n\t\t\t            let data = {'phone':this.loginForm.adminphone}  //POST 请求需要 转化为Form\r\n\t\t\t            this.axios.post('http://47.100.125.167:7080/auth/sms_code', data)\r\n\t\t\t\t\t\t.then( res => {\r\n\t\t\t                console.log(res);\r\n\t\t\t\t\t\t\tconsole.log(res.data);\r\n\t\t\t            })\r\n\t\t\t        }\r\n\t\t\t    })\r\n\t\t\t},\r\n\t\t\ttackBtn(){       //验证码倒数60秒\r\n\t\t\t\tlet time = 60;\r\n\t\t\t\tlet timer = setInterval(() => {\r\n\t\t\t\t\tif(time == 0){\r\n\t\t\t\t\t\tclearInterval(timer);\r\n\t\t\t\t\t\tthis.valiBtn = '获取验证码';\r\n\t\t\t\t\t\tthis.disabled = false;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.disabled = true;\r\n\t\t\t\t\t\tthis.valiBtn = time + '秒后重试';\r\n\t\t\t\t\t\ttime--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1000);\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\tbody {\r\n\t\tbackground-color: #004343;\r\n\t}\r\n\t.verification .el-input{\r\n\t\twidth:138px;\r\n\t\tmargin-right: 10px;\r\n\t}\r\n\t.verification .el-button{\r\n\t}\r\n</style>\n"]}]}