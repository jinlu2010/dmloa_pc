{"remainingRequest":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\HBuilderProjects\\dmloa_pc\\src\\pages\\index\\company\\Edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\HBuilderProjects\\dmloa_pc\\src\\pages\\index\\company\\Edit.vue","mtime":1625740347641},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615258085839},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\babel-loader\\lib\\index.js","mtime":1615258097485},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615258085839},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\vue-loader\\lib\\index.js","mtime":1615258095774}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tdata() {\n\t\tvar checkPhone = (rule, value, callback) => {\n\t\t\tif (!value) {\n\t\t\t\treturn callback(new Error('手机号码不能为空'));\n\t\t\t}\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (value.length < 11) {\n\t\t\t\t\tcallback(new Error('手机号码不正确'));\n\t\t\t\t} else {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t};\n\t\tvar validatePass = (rule, value, callback) => {\n\t\t\tif (value === '') {\n\t\t\t\tcallback(new Error('请输入密码'));\n\t\t\t} else {\n\t\t\t\tif (this.forgetForm.checkpassword !== '') {\n\t\t\t\t\tthis.$refs.forgetForm.validateField('checkpassword');\n\t\t\t\t}\n\t\t\t\tcallback();\n\t\t\t}\n\t\t};\n\t\tvar validatePass2 = (rule, value, callback) => {\n\t\t\tif (value === '') {\n\t\t\t\tcallback(new Error('请再次输入密码'));\n\t\t\t} else if (value !== this.forgetForm.password) {\n\t\t\t\tcallback(new Error('两次输入密码不一致!'));\n\t\t\t} else {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t};\n\t\treturn {\n\t\t\tvaliBtn:'获取验证码',\n\t\t\tsmscode: '', //修改密码时的验证码\n\t\t\tforgetForm: {\n\t\t\t\tadminphone: '',\n\t\t\t\tpassword: '',\n\t\t\t\tcheckpassword: '',\n\t\t\t\tsmscode: ''\n\t\t\t},\n\t\t\trules: {\n\t\t\t\tadminphone: [{validator: checkPhone,trigger: 'blur'}],\n\t\t\t\tpassword: [{validator: validatePass,trigger: 'blur'}],\n\t\t\t\tcheckpassword: [{validator: validatePass2,trigger: 'blur'}]\n\t\t\t}\n\t\t};\n\t},\n\tmethods: {\n\t\tonReset: function() {\n\t\t\t// 先验证验证码\n\t\t\tif (this.forgetForm.smscode == '' || this.smscode == '' || this.smscode != this.forgetForm.smscode) {\n\t\t\t\talert('验证码不正确');\n\t\t\t}\n\t\t\tvar userid = window.localStorage.getItem(\"logintoken\")\n\t\t\tlet data={\n\t\t\t\tid:userid,\n\t\t\t\tphone:this.forgetForm.adminphone,\n\t\t\t\tpassword:this.forgetForm.password,\n\t\t\t}\n\t\t\tlet password = JSON.stringify(data);\n\t\t\tlet params = new URLSearchParams();\n\t\t\tparams.append(\"password\", password);\n\t\t\tthis.$refs['forgetForm'].validate((valid) => {\n\t\t\t    if (valid) {\n\t\t\t\t\tthis.axios.post('api/editpwd/', params)\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tconsole.log(res)\n\t\t\t\t\t\tif (res.data.code == 0) {\n\t\t\t\t\t\t\talert('恭喜您，修改成功！');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.message = res.data.message\n\t\t\t\t\t\t\talert(this.message)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t    } else {\n\t\t\t\t\tconsole.log('error submit!!');\n\t\t\t    }\n\t\t\t})\n\t\t},\n\t\t\n\t\t//获取修改密码短信验证码\n\t\tgetCodeForget(){\n\t\t   this.$refs['forgetForm'].validateField('adminphone', (err) =>{\n\t\t        if(err){\n\t\t            console.log('未通过', this.forgetForm.adminphone)\n\t\t            return;\n\t\t        }else{\n\t\t            console.log('已通过', this.forgetForm.adminphone)\n\t\t\t\t\tlet phone = this.forgetForm.adminphone\n\t\t\t\t\tlet staffid = window.localStorage.getItem(\"logintoken\")\n\t\t\t\t\tlet params = new URLSearchParams();\n\t\t\t\t\tparams.append(\"staffid\", staffid);\n\t\t\t\t\tlet that = this;\n\t\t\t\t\tthat.axios.post('api/stafflist/', params)\n\t\t\t\t\t  .then(function (resp) {\n\t\t\t\t\t\t  console.log(resp.data);\n\t\t\t\t\t\t  if(phone == resp.data[0].phone){\n\t\t\t\t\t\t\t  that.tackBtn(); //验证码倒数60秒\t\n\t\t\t\t\t\t\t  let myurl = 'api/smscode/' + phone + \"/\"\n\t\t\t\t\t\t\t  that.axios.get(myurl)\n\t\t\t\t\t\t\t  .then(res => {\n\t\t\t\t\t\t\t  \tconsole.log('服务端生成的验证码', res.data) \n\t\t\t\t\t\t\t  \tthat.smscode = res.data\n\t\t\t\t\t\t\t  })\n\t\t\t\t\t\t  }else{\n\t\t\t\t\t\t\t  alert('手机号码与注册时的号码不一致，请重新输入！')\n\t\t\t\t\t\t  }\n\t\t\t\t\t  })\n\t\t\t\t\t  .catch(function (error) {\n\t\t\t\t\t\t  console.log(error);\n\t\t\t\t\t  });\n\t\t        }\n\t\t    })\n\t\t},\n\t\t//验证码倒数60秒\n\t\ttackBtn(){       \n\t\t\tlet time = 60;\n\t\t\tlet timer = setInterval(() => {\n\t\t\t\tif(time == 0){\n\t\t\t\t\tclearInterval(timer);\n\t\t\t\t\tthis.valiBtn = '获取验证码';\n\t\t\t\t\tthis.disabled = false;\n\t\t\t\t}else{\n\t\t\t\t\tthis.disabled = true;\n\t\t\t\t\tthis.valiBtn = time + '秒后重试';\n\t\t\t\t\ttime--;\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t},\n\t}\n}\n",{"version":3,"sources":["Edit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Edit.vue","sourceRoot":"src/pages/index/company","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<el-form :model=\"forgetForm\" :rules=\"rules\" ref=\"forgetForm\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n\t\t\t<el-form-item label=\"管理员手机\" prop=\"adminphone\">\r\n\t\t\t\t<el-input v-model=\"forgetForm.adminphone\"></el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item label=\"短信验证码\" prop=\"smscode\" class=\"verification\">\r\n\t\t\t\t<el-input v-model=\"forgetForm.smscode\"></el-input>\r\n\t\t\t\t<el-button @click=\"getCodeForget\">{{valiBtn}}</el-button>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item label=\"登录密码\" prop=\"password\">\r\n\t\t\t\t<el-input type=\"password\" v-model=\"forgetForm.password\" autocomplete=\"off\"></el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item label=\"确认密码\" prop=\"checkpassword\">\r\n\t\t\t\t<el-input type=\"password\" v-model=\"forgetForm.checkpassword\" autocomplete=\"off\"></el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"onReset('forgetForm')\">重置</el-button>\r\n\t\t\t</el-form-item>\r\n\t\t</el-form>\r\n\t</div>\n</template>\n\n<script>\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\tvar checkPhone = (rule, value, callback) => {\r\n\t\t\t\tif (!value) {\r\n\t\t\t\t\treturn callback(new Error('手机号码不能为空'));\r\n\t\t\t\t}\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tif (value.length < 11) {\r\n\t\t\t\t\t\tcallback(new Error('手机号码不正确'));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1000);\r\n\t\t\t};\r\n\t\t\tvar validatePass = (rule, value, callback) => {\r\n\t\t\t\tif (value === '') {\r\n\t\t\t\t\tcallback(new Error('请输入密码'));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (this.forgetForm.checkpassword !== '') {\r\n\t\t\t\t\t\tthis.$refs.forgetForm.validateField('checkpassword');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcallback();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar validatePass2 = (rule, value, callback) => {\r\n\t\t\t\tif (value === '') {\r\n\t\t\t\t\tcallback(new Error('请再次输入密码'));\r\n\t\t\t\t} else if (value !== this.forgetForm.password) {\r\n\t\t\t\t\tcallback(new Error('两次输入密码不一致!'));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\treturn {\r\n\t\t\t\tvaliBtn:'获取验证码',\r\n\t\t\t\tsmscode: '', //修改密码时的验证码\r\n\t\t\t\tforgetForm: {\r\n\t\t\t\t\tadminphone: '',\r\n\t\t\t\t\tpassword: '',\r\n\t\t\t\t\tcheckpassword: '',\r\n\t\t\t\t\tsmscode: ''\r\n\t\t\t\t},\r\n\t\t\t\trules: {\r\n\t\t\t\t\tadminphone: [{validator: checkPhone,trigger: 'blur'}],\r\n\t\t\t\t\tpassword: [{validator: validatePass,trigger: 'blur'}],\r\n\t\t\t\t\tcheckpassword: [{validator: validatePass2,trigger: 'blur'}]\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tonReset: function() {\r\n\t\t\t\t// 先验证验证码\r\n\t\t\t\tif (this.forgetForm.smscode == '' || this.smscode == '' || this.smscode != this.forgetForm.smscode) {\r\n\t\t\t\t\talert('验证码不正确');\r\n\t\t\t\t}\r\n\t\t\t\tvar userid = window.localStorage.getItem(\"logintoken\")\r\n\t\t\t\tlet data={\r\n\t\t\t\t\tid:userid,\r\n\t\t\t\t\tphone:this.forgetForm.adminphone,\r\n\t\t\t\t\tpassword:this.forgetForm.password,\r\n\t\t\t\t}\r\n\t\t\t\tlet password = JSON.stringify(data);\r\n\t\t\t\tlet params = new URLSearchParams();\r\n\t\t\t\tparams.append(\"password\", password);\r\n\t\t\t\tthis.$refs['forgetForm'].validate((valid) => {\r\n\t\t\t\t    if (valid) {\r\n\t\t\t\t\t\tthis.axios.post('api/editpwd/', params)\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t\tif (res.data.code == 0) {\r\n\t\t\t\t\t\t\t\talert('恭喜您，修改成功！');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.message = res.data.message\r\n\t\t\t\t\t\t\t\talert(this.message)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t    } else {\r\n\t\t\t\t\t\tconsole.log('error submit!!');\r\n\t\t\t\t    }\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t//获取修改密码短信验证码\r\n\t\t\tgetCodeForget(){\r\n\t\t\t   this.$refs['forgetForm'].validateField('adminphone', (err) =>{\r\n\t\t\t        if(err){\r\n\t\t\t            console.log('未通过', this.forgetForm.adminphone)\r\n\t\t\t            return;\r\n\t\t\t        }else{\r\n\t\t\t            console.log('已通过', this.forgetForm.adminphone)\r\n\t\t\t\t\t\tlet phone = this.forgetForm.adminphone\r\n\t\t\t\t\t\tlet staffid = window.localStorage.getItem(\"logintoken\")\r\n\t\t\t\t\t\tlet params = new URLSearchParams();\r\n\t\t\t\t\t\tparams.append(\"staffid\", staffid);\r\n\t\t\t\t\t\tlet that = this;\r\n\t\t\t\t\t\tthat.axios.post('api/stafflist/', params)\r\n\t\t\t\t\t\t  .then(function (resp) {\r\n\t\t\t\t\t\t\t  console.log(resp.data);\r\n\t\t\t\t\t\t\t  if(phone == resp.data[0].phone){\r\n\t\t\t\t\t\t\t\t  that.tackBtn(); //验证码倒数60秒\t\r\n\t\t\t\t\t\t\t\t  let myurl = 'api/smscode/' + phone + \"/\"\r\n\t\t\t\t\t\t\t\t  that.axios.get(myurl)\r\n\t\t\t\t\t\t\t\t  .then(res => {\r\n\t\t\t\t\t\t\t\t  \tconsole.log('服务端生成的验证码', res.data) \r\n\t\t\t\t\t\t\t\t  \tthat.smscode = res.data\r\n\t\t\t\t\t\t\t\t  })\r\n\t\t\t\t\t\t\t  }else{\r\n\t\t\t\t\t\t\t\t  alert('手机号码与注册时的号码不一致，请重新输入！')\r\n\t\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t  })\r\n\t\t\t\t\t\t  .catch(function (error) {\r\n\t\t\t\t\t\t\t  console.log(error);\r\n\t\t\t\t\t\t  });\r\n\t\t\t        }\r\n\t\t\t    })\r\n\t\t\t},\r\n\t\t\t//验证码倒数60秒\r\n\t\t\ttackBtn(){       \r\n\t\t\t\tlet time = 60;\r\n\t\t\t\tlet timer = setInterval(() => {\r\n\t\t\t\t\tif(time == 0){\r\n\t\t\t\t\t\tclearInterval(timer);\r\n\t\t\t\t\t\tthis.valiBtn = '获取验证码';\r\n\t\t\t\t\t\tthis.disabled = false;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.disabled = true;\r\n\t\t\t\t\t\tthis.valiBtn = time + '秒后重试';\r\n\t\t\t\t\t\ttime--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1000);\r\n\t\t\t},\r\n\t\t}\r\n\t}\n</script>\n\n<style>\r\n\t.verification .el-input{\r\n\t\twidth:138px;\r\n\t\tmargin-right: 10px;\r\n\t}\n</style>\n"]}]}