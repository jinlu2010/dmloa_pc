{"remainingRequest":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\babel-loader\\lib\\index.js!D:\\HBuilderProjects\\dmloa_pc\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\HBuilderProjects\\dmloa_pc\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\HBuilderProjects\\dmloa_pc\\src\\pages\\login\\Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\HBuilderProjects\\dmloa_pc\\src\\pages\\login\\Login.vue","mtime":1647937988419},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615258085839},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\babel-loader\\lib\\index.js","mtime":1615258097485},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615258085839},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\vue-loader\\lib\\index.js","mtime":1615258095774}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from 'axios';\nexport default {\n  data: function data() {\n    var checkPhone = function checkPhone(rule, value, callback) {\n      if (!value) {\n        return callback(new Error('手机号码不能为空'));\n      }\n\n      setTimeout(function () {\n        if (value.length < 11) {\n          callback(new Error('手机号码不正确'));\n        } else {\n          callback();\n        }\n      }, 1000);\n    };\n\n    var validatePass = function validatePass(rule, value, callback) {\n      if (value === '') {\n        callback(new Error('请输入密码'));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      loginsmscode: '',\n      // 短信登录验证码\n      registersmscode: '',\n      //注册时的验证码\n      activeName: 'first',\n      showLogin: true,\n      showRegister: false,\n      valiBtn: '获取验证码',\n      phone: '',\n      loginForm: {\n        adminaccount: '',\n        password: '',\n        adminphone: '',\n        smscode: ''\n      },\n      registerForm: {\n        companyname: '',\n        industry: '',\n        adminname: '',\n        adminphone: '',\n        adminaccount: '',\n        password: '',\n        smscode: ''\n      },\n      rules: {\n        adminaccount: [{\n          required: true,\n          message: '请输入用户名',\n          trigger: 'blur'\n        }],\n        adminphone: [{\n          required: true,\n          validator: checkPhone,\n          trigger: 'blur'\n        }],\n        password: [{\n          required: true,\n          validator: validatePass,\n          trigger: 'blur'\n        }],\n        companyname: [{\n          required: true,\n          message: '请输入公司名称',\n          trigger: 'blur'\n        }],\n        industry: [{\n          message: '请选择行业类型',\n          trigger: 'change'\n        }],\n        adminname: [{\n          required: true,\n          message: '请输入管理员姓名',\n          trigger: 'blur'\n        }],\n        smscode: [{\n          required: true,\n          message: '请输入短信验证码',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    LoginPwd: function LoginPwd() {\n      var that = this;\n      var data = {\n        \"account\": this.loginForm.adminaccount,\n        \"password\": this.loginForm.password\n      };\n      var LoginInfo = JSON.stringify(data);\n      console.log(LoginInfo);\n      var params = new URLSearchParams();\n      params.append('LoginInfo', LoginInfo);\n      this.axios.post('api/loginpwd/', params).then(function (res) {\n        console.log(res.data);\n\n        if (res.data.code == 0) {\n          alert(res.data.message);\n        } else {\n          alert(res.data.message);\n          var token = res.data.userid;\n          localStorage.setItem('logintoken', token);\n          that.$router.push('/index');\n        }\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    //获取登录短信验证码\n    getCodeLogin: function getCodeLogin() {\n      var _this = this;\n\n      this.$refs['loginForm'].validateField('adminphone', function (err) {\n        if (err) {\n          console.log('未通过', _this.loginForm.adminphone);\n          return;\n        } else {\n          console.log('已通过', _this.loginForm.adminphone);\n          var phone = _this.loginForm.adminphone;\n\n          _this.tackBtn(); //验证码倒数60秒\t\n\n\n          var myurl = 'api/smscode/' + phone + \"/\";\n\n          _this.axios.get(myurl).then(function (res) {\n            console.log('服务端生成的验证码', res.data);\n            _this.loginsmscode = res.data;\n          });\n        }\n      });\n    },\n    //获取注册短信验证码\n    getCodeRegister: function getCodeRegister() {\n      var _this2 = this;\n\n      this.$refs['registerForm'].validateField('adminphone', function (err) {\n        if (err) {\n          console.log('未通过', _this2.registerForm.adminphone);\n          return;\n        } else {\n          console.log('已通过', _this2.registerForm.adminphone);\n          var phone = _this2.registerForm.adminphone;\n\n          _this2.tackBtn(); //验证码倒数60秒\t\n\n\n          var myurl = 'api/smscode/' + phone + \"/\";\n\n          _this2.axios.get(myurl).then(function (res) {\n            console.log('服务端生成的验证码', res.data);\n            _this2.registersmscode = res.data;\n          });\n        }\n      });\n    },\n    //验证码倒数60秒\n    tackBtn: function tackBtn() {\n      var _this3 = this;\n\n      var time = 60;\n      var timer = setInterval(function () {\n        if (time == 0) {\n          clearInterval(timer);\n          _this3.valiBtn = '获取验证码';\n          _this3.disabled = false;\n        } else {\n          _this3.disabled = true;\n          _this3.valiBtn = time + '秒后重试';\n          time--;\n        }\n      }, 1000);\n    },\n    LoginSms: function LoginSms() {\n      var _this4 = this;\n\n      // 先验证验证码\n      if (this.loginForm.smscode == '' || this.loginsmscode == '' || this.loginsmscode != this.loginForm.smscode) {\n        alert('验证码不正确');\n        return;\n      }\n\n      var phone = this.loginForm.adminphone;\n      var myurl = 'api/loginsms/' + phone + \"/\";\n      this.axios.get(myurl).then(function (res) {\n        console.log(res);\n\n        if (res.data.code == 1) {\n          alert('登录成功');\n          var token = res.data.userid;\n          localStorage.setItem('logintoken', token);\n\n          _this4.$router.push('/index');\n\n          return;\n        }\n\n        if (res.data.code == 0) {\n          alert('该手机号没有注册,请先去注册');\n          return;\n        }\n      });\n    },\n    Register: function Register() {\n      var _this5 = this;\n\n      if (this.registerForm.smscode == '' || this.registersmscode == '' || this.registersmscode != this.registerForm.smscode) {\n        alert('验证码不正确');\n        return;\n      }\n\n      var data = {\n        company_name: this.registerForm.companyname,\n        industry: this.registerForm.industry,\n        name: this.registerForm.adminname,\n        phone: this.registerForm.adminphone,\n        account: this.registerForm.adminaccount,\n        password: this.registerForm.password\n      };\n      var newcompany = JSON.stringify(data);\n      console.log(newcompany);\n      var params = new URLSearchParams();\n      params.append(\"newcompany\", newcompany);\n      this.$refs['registerForm'].validate(function (valid) {\n        if (valid) {\n          _this5.axios.post('api/register/', params).then(function (res) {\n            console.log(res);\n\n            if (res.data.code == 0) {\n              alert('恭喜您，成功开通！');\n              var token = res.data.userid; // localStorage.setItem('token', token);\n            } else {\n              _this5.message = res.data.message;\n              alert(_this5.message);\n            }\n          });\n\n          setTimeout(function () {\n            _this5.showRegister = false;\n            _this5.showLogin = true;\n          }, 3000);\n        } else {\n          console.log('error submit!!');\n          _this5.showRegister = true;\n          _this5.showLogin = false;\n          return false;\n        }\n      });\n    },\n    ToRegister: function ToRegister() {\n      this.showRegister = true;\n      this.showLogin = false;\n    },\n    ToLogin: function ToLogin() {\n      this.showRegister = false;\n      this.showLogin = true;\n    },\n    handleClick: function handleClick(tab, event) {\n      console.log(tab, event);\n    }\n  }\n};",{"version":3,"sources":["Login.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<div id=\"login\">\r\n\t\t<h1>段马乐OA管理后台</h1>\r\n\t\t<div class=\"login-layout\" v-show=\"showLogin\">\r\n\t\t\t<el-tabs v-model=\"activeName\" @tab-click=\"handleClick\">\r\n\t\t\t\t<el-tab-pane label=\"密码登录\" name=\"first\">\r\n\t\t\t\t\t<el-form :model=\"loginForm\" status-icon ref=\"loginForm\" label-width=\"100px\"\r\n\t\t\t\t\t\tclass=\"demo-ruleForm\" :rules=\"rules\">\r\n\t\t\t\t\t\t<el-form-item label=\"管理员账户\" prop=\"adminaccount\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"loginForm.adminaccount\"></el-input>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t<el-form-item label=\"密码\" prop=\"password\">\r\n\t\t\t\t\t\t\t<el-input type=\"password\" v-model=\"loginForm.password\"></el-input>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"LoginPwd\">登录</el-button>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"ToRegister\">注册</el-button>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</el-form>\r\n\t\t\t\t</el-tab-pane>\r\n\t\t\t\t<el-tab-pane label=\"短信登录\" name=\"second\">\r\n\t\t\t\t\t<el-form :model=\"loginForm\" status-icon ref=\"loginForm\" label-width=\"100px\"\r\n\t\t\t\t\t\tclass=\"demo-ruleForm\" :rules=\"rules\">\r\n\t\t\t\t\t\t<el-form-item label=\"管理员手机\" prop=\"adminphone\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"loginForm.adminphone\"></el-input>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t<el-form-item label=\"短信验证码\" prop=\"smscode\" class=\"verification\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"loginForm.smscode\"></el-input>\r\n\t\t\t\t\t\t\t<el-button @click=\"getCodeLogin\">{{valiBtn}}</el-button>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"LoginSms\">登录</el-button>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"ToRegister\">注册</el-button>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</el-form>\r\n\t\t\t\t</el-tab-pane>\r\n\t\t\t</el-tabs>\r\n\t\t</div>\r\n\t\t<div class=\"register-layout\" v-show=\"showRegister\">\r\n\t\t\t<el-form :model=\"registerForm\" :rules=\"rules\" ref=\"registerForm\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n\t\t\t\t<el-form-item label=\"企业名称\" prop=\"companyname\">\r\n\t\t\t\t\t<el-input v-model=\"registerForm.companyname\"></el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"行业类型\" prop=\"industry\">\r\n\t\t\t\t\t<el-select v-model=\"registerForm.industry\" placeholder=\"请选择行业类型\">\r\n\t\t\t\t\t\t<el-option label=\"类型一\" value=\"one\"></el-option>\r\n\t\t\t\t\t\t<el-option label=\"类型二\" value=\"two\"></el-option>\r\n\t\t\t\t\t</el-select>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"管理员姓名\" prop=\"adminname\">\r\n\t\t\t\t\t<el-input v-model=\"registerForm.adminname\"></el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"管理员账户\" prop=\"adminaccount\">\r\n\t\t\t\t\t<el-input v-model=\"registerForm.adminaccount\"></el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"登录密码\" prop=\"password\">\r\n\t\t\t\t\t<el-input type=\"password\" v-model=\"registerForm.password\"></el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t\r\n\t\t\t\t<el-form-item label=\"管理员手机\" prop=\"adminphone\">\r\n\t\t\t\t\t<el-input v-model=\"registerForm.adminphone\"></el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"短信验证码\" prop=\"smscode\" class=\"verification\">\r\n\t\t\t\t\t<el-input v-model=\"registerForm.smscode\"></el-input>\r\n\t\t\t\t\t<el-button @click=\"getCodeRegister\">{{valiBtn}}</el-button>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t\r\n\t\t\t\t<el-form-item>\r\n\t\t\t\t\t<el-button type=\"primary\" @click=\"Register\">注册</el-button>\r\n\t\t\t\t\t<el-button type=\"text\" @click=\"ToLogin\">返回登录</el-button>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t</el-form>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport axios from 'axios'\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\tvar checkPhone = (rule, value, callback) => {\r\n\t\t\t\tif (!value) {\r\n\t\t\t\t\treturn callback(new Error('手机号码不能为空'));\r\n\t\t\t\t}\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tif (value.length < 11) {\r\n\t\t\t\t\t\tcallback(new Error('手机号码不正确'));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1000);\r\n\t\t\t};\r\n\t\t\tvar validatePass = (rule, value, callback) => {\r\n\t\t\t\tif (value === '') {\r\n\t\t\t\t\tcallback(new Error('请输入密码'));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\treturn {\r\n\t\t\t\tloginsmscode: '', // 短信登录验证码\r\n\t\t\t\tregistersmscode: '', //注册时的验证码\r\n\t\t\t\tactiveName: 'first',\r\n\t\t\t\tshowLogin: true,\r\n\t\t\t\tshowRegister: false,\r\n\t\t\t\tvaliBtn:'获取验证码',\r\n\t\t\t\tphone:'',\r\n\t\t\t\tloginForm: {\r\n\t\t\t\t\tadminaccount: '',\r\n\t\t\t\t\tpassword: '',\r\n\t\t\t\t\tadminphone: '',\r\n\t\t\t\t\tsmscode: ''\r\n\t\t\t\t},\r\n\t\t\t\tregisterForm: {\r\n\t\t\t\t\tcompanyname: '',\r\n\t\t\t\t\tindustry: '',\r\n\t\t\t\t\tadminname: '',\r\n\t\t\t\t\tadminphone: '',\r\n\t\t\t\t\tadminaccount: '',\r\n\t\t\t\t\tpassword:'',\r\n\t\t\t\t\tsmscode: '',\r\n\t\t\t\t},\r\n\t\t\t\trules: {\r\n\t\t\t\t\tadminaccount: [{required: true,message: '请输入用户名',trigger: 'blur'}],\r\n\t\t\t\t\tadminphone: [{required: true,validator: checkPhone,trigger: 'blur'}],\r\n\t\t\t\t\tpassword: [{required: true,validator: validatePass,trigger: 'blur'}],\r\n\t\t\t\t\tcompanyname: [{required: true,message: '请输入公司名称',trigger: 'blur'}],\r\n\t\t\t\t\tindustry: [{message: '请选择行业类型',trigger: 'change'}],\r\n\t\t\t\t\tadminname: [{required: true,message: '请输入管理员姓名',trigger: 'blur'}],\r\n\t\t\t\t\tsmscode: [{required: true,message: '请输入短信验证码',trigger: 'blur'},]\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tLoginPwd: function () {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tvar data = {\r\n\t\t\t\t\t\"account\": this.loginForm.adminaccount,\r\n\t\t\t\t\t\"password\": this.loginForm.password\r\n\t\t\t\t}\r\n\t\t\t\tlet LoginInfo = JSON.stringify(data);\r\n\t\t\t\tconsole.log(LoginInfo);\r\n\t\t\t\tlet params = new URLSearchParams();\r\n\t\t\t\tparams.append('LoginInfo', LoginInfo);\r\n\t\t\t\tthis.axios.post('api/loginpwd/',params)\r\n\t\t\t\t.then(function (res) {\r\n\t\t\t\t\tconsole.log(res.data)\r\n\t\t\t\t\tif (res.data.code == 0) {\r\n\t\t\t            alert(res.data.message)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert(res.data.message);\r\n\t\t\t\t\t\tlet token = res.data.userid;\r\n\t\t\t\t\t\tlocalStorage.setItem('logintoken', token);\r\n\t\t\t\t\t\tthat.$router.push('/index')\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(function (error) {\r\n\t\t\t\t\tconsole.log(error);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t//获取登录短信验证码\r\n\t\t\tgetCodeLogin(){\r\n\t\t\t   this.$refs['loginForm'].validateField('adminphone', (err) =>{\r\n\t\t\t        if(err){\r\n\t\t\t            console.log('未通过', this.loginForm.adminphone)\r\n\t\t\t            return;\r\n\t\t\t        }else{\r\n\t\t\t            console.log('已通过', this.loginForm.adminphone)\r\n\t\t\t\t\t\tlet phone = this.loginForm.adminphone\r\n\t\t\t\t\t\tthis.tackBtn(); //验证码倒数60秒\t\r\n\t\t\t\t\t\tlet myurl = 'api/smscode/' + phone + \"/\"\r\n\t\t\t\t\t\tthis.axios.get(myurl)\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconsole.log('服务端生成的验证码', res.data) \r\n\t\t\t\t\t\t\tthis.loginsmscode = res.data\r\n\t\t\t\t\t\t})\r\n\t\t\t        }\r\n\t\t\t    })\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t//获取注册短信验证码\r\n\t\t\tgetCodeRegister(){\r\n\t\t\t   this.$refs['registerForm'].validateField('adminphone', (err) =>{\r\n\t\t\t        if(err){\r\n\t\t\t            console.log('未通过', this.registerForm.adminphone)\r\n\t\t\t            return;\r\n\t\t\t        }else{\r\n\t\t\t            console.log('已通过', this.registerForm.adminphone)\r\n\t\t\t            let phone = this.registerForm.adminphone\r\n\t\t\t            this.tackBtn(); //验证码倒数60秒\t\r\n\t\t\t            let myurl = 'api/smscode/' + phone + \"/\"\r\n\t\t\t            this.axios.get(myurl)\r\n\t\t\t            .then(res => {\r\n\t\t\t            \tconsole.log('服务端生成的验证码', res.data) \r\n\t\t\t            \tthis.registersmscode = res.data\r\n\t\t\t            })\r\n\t\t\t        }\r\n\t\t\t    })\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t//验证码倒数60秒\r\n\t\t\ttackBtn(){       \r\n\t\t\t\tlet time = 60;\r\n\t\t\t\tlet timer = setInterval(() => {\r\n\t\t\t\t\tif(time == 0){\r\n\t\t\t\t\t\tclearInterval(timer);\r\n\t\t\t\t\t\tthis.valiBtn = '获取验证码';\r\n\t\t\t\t\t\tthis.disabled = false;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.disabled = true;\r\n\t\t\t\t\t\tthis.valiBtn = time + '秒后重试';\r\n\t\t\t\t\t\ttime--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1000);\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tLoginSms: function() {\r\n\t\t\t\t// 先验证验证码\r\n\t\t\t\tif (this.loginForm.smscode == '' || this.loginsmscode == '' || this.loginsmscode != this.loginForm.smscode) {\r\n\t\t\t\t\talert('验证码不正确');\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tlet phone = this.loginForm.adminphone;\r\n\t\t\t\tlet myurl = 'api/loginsms/' + phone + \"/\";\r\n\t\t\t\tthis.axios.get(myurl)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tif (res.data.code == 1) {\r\n\t\t\t\t\t\talert('登录成功');\r\n\t\t\t\t\t\tlet token = res.data.userid\r\n\t\t\t\t\t\tlocalStorage.setItem('logintoken', token);\r\n\t\t\t\t\t\tthis.$router.push('/index')\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (res.data.code == 0) {\r\n\t\t\t\t\t\talert('该手机号没有注册,请先去注册');\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tRegister: function() {\r\n\t\t\t\tif (this.registerForm.smscode == '' || this.registersmscode == '' || this.registersmscode != this.registerForm.smscode) {\r\n\t\t\t\t\talert('验证码不正确');\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tlet data={\r\n\t\t\t\t\tcompany_name:this.registerForm.companyname,\r\n\t\t\t\t\tindustry:this.registerForm.industry,\r\n\t\t\t\t\tname:this.registerForm.adminname,\r\n\t\t\t\t\tphone:this.registerForm.adminphone,\r\n\t\t\t\t\taccount:this.registerForm.adminaccount,\r\n\t\t\t\t\tpassword:this.registerForm.password\r\n\t\t\t\t}\r\n\t\t\t\tlet newcompany = JSON.stringify(data);\r\n\t\t\t\tconsole.log(newcompany);\r\n\t\t\t\tlet params = new URLSearchParams();\r\n\t\t\t\tparams.append(\"newcompany\", newcompany);\r\n\t\t\t\tthis.$refs['registerForm'].validate((valid) => {\r\n\t\t\t\t    if (valid) {\r\n\t\t\t\t\t\tthis.axios.post('api/register/', params)\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t\tif (res.data.code == 0) {\r\n\t\t\t\t\t\t\t\talert('恭喜您，成功开通！');\r\n\t\t\t\t\t\t\t\tlet token = res.data.userid;\r\n\t\t\t\t\t\t\t\t// localStorage.setItem('token', token);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.message = res.data.message\r\n\t\t\t\t\t\t\t\talert(this.message)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tthis.showRegister = false\r\n\t\t\t\t\t\t\tthis.showLogin = true\r\n\t\t\t\t\t\t}, 3000);\r\n\t\t\t\t    } else {\r\n\t\t\t\t\t\tconsole.log('error submit!!');\r\n\t\t\t\t\t\tthis.showRegister = true\r\n\t\t\t\t\t\tthis.showLogin = false\r\n\t\t\t\t        return false;\r\n\t\t\t\t    }\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tToRegister() {\r\n\t\t\t\tthis.showRegister = true\r\n\t\t\t\tthis.showLogin = false\r\n\t\t\t},\r\n\t\t\tToLogin() {\r\n\t\t\t\tthis.showRegister = false\r\n\t\t\t\tthis.showLogin = true\r\n\t\t\t},\r\n\t\t\thandleClick(tab, event) {\r\n\t\t\t\tconsole.log(tab, event);\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\tbody {\r\n\t\tbackground-color: #004343;\r\n\t}\r\n\t.verification .el-input{\r\n\t\twidth:138px;\r\n\t\tmargin-right: 10px;\r\n\t}\r\n</style>\n"],"sourceRoot":"src/pages/login"}]}