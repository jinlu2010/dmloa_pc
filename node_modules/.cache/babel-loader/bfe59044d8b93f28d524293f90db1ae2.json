{"remainingRequest":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\babel-loader\\lib\\index.js!D:\\HBuilderProjects\\dmloa_pc\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\HBuilderProjects\\dmloa_pc\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\HBuilderProjects\\dmloa_pc\\src\\pages\\index\\staff\\List.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\HBuilderProjects\\dmloa_pc\\src\\pages\\index\\staff\\List.vue","mtime":1633688147162},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615258085839},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\babel-loader\\lib\\index.js","mtime":1615258097485},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615258085839},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\vue-loader\\lib\\index.js","mtime":1615258095774}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.find-index\";\nimport \"core-js/modules/es6.array.index-of\";\nimport \"core-js/modules/es6.regexp.replace\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  inject: ['reload'],\n  data: function data() {\n    return {\n      stafflist: [],\n      alldeptlist: [],\n      message: '',\n      form: {\n        id: '',\n        deptname: '',\n        deptsense: '',\n        deptgoal: '',\n        deptduty: ''\n      },\n      deptpopup: false\n    };\n  },\n  mounted: function mounted() {\n    var that = this;\n    var userid = window.localStorage.getItem(\"logintoken\");\n    console.log(userid);\n    that.axios.post(\"api/allstafflist/\").then(function (resp) {\n      console.log(resp.data);\n      var staff = resp.data;\n      that.stafflist = resp.data;\n    }).catch(function (error) {\n      console.log(error);\n    });\n    that.axios.post(\"api/alldeptlist/\").then(function (resp) {\n      console.log(resp.data);\n      var post = JSON.stringify(resp.data);\n      post = post.replace(/deptname/g, \"label\");\n      post = post.replace(/post/g, \"children\");\n      post = post.replace(/childrenname/g, \"label\");\n      post = JSON.parse(post);\n      that.alldeptlist = post;\n      that.$forceUpdate();\n    }).catch(function (error) {\n      console.log(error);\n    });\n  },\n  methods: {\n    handleNodeClick: function handleNodeClick(data) {\n      console.log(data.label);\n      console.log(data.id);\n      var that = this;\n\n      if (data.label.indexOf(\"部\") != -1) {\n        var deptid = data.id;\n        var params = new URLSearchParams();\n        params.append(\"deptid\", deptid);\n        that.axios.post('api/staffdeptlist/', params).then(function (resp) {\n          console.log(resp.data);\n          var staff = resp.data;\n          that.stafflist = resp.data;\n        });\n      } else {\n        var postid = data.id;\n\n        var _params = new URLSearchParams();\n\n        _params.append(\"postid\", postid);\n\n        that.axios.post('api/staffpostlist/', _params).then(function (resp) {\n          console.log(resp.data);\n          var staff = resp.data;\n          that.stafflist = resp.data;\n        });\n      }\n    },\n    getdeptid: function getdeptid(node, data) {\n      var parent = node.parent;\n      var children = parent.data.children || parent.data;\n      var index = children.findIndex(function (d) {\n        return d.id === data.id;\n      });\n      var postid = data.id;\n      var that = this;\n\n      if (data.label.indexOf(\"部\") != -1) {\n        this.deptpopup = true;\n        var deptid = data.id;\n        var params = new URLSearchParams();\n        params.append(\"deptid\", deptid);\n        that.axios.post('api/deptlist/', params).then(function (resp) {\n          console.log(resp.data);\n          that.form.id = resp.data[0].id;\n          that.form.deptname = resp.data[0].deptname.replace('部', '');\n          that.form.deptsense = resp.data[0].sense;\n          that.form.deptgoal = resp.data[0].goal;\n          that.form.deptduty = resp.data[0].duty;\n        }).catch(function (error) {\n          console.log(error);\n        });\n      } else {\n        this.$router.push({\n          name: 'editpost',\n          params: {\n            id: postid\n          }\n        });\n      }\n    },\n    edit: function edit() {\n      var _this = this;\n\n      var data = {\n        id: this.form.id,\n        name: this.form.deptname + '部',\n        sense: this.form.deptsense,\n        goal: this.form.deptgoal,\n        duty: this.form.deptduty\n      };\n      var dept = JSON.stringify(data);\n      console.log(dept);\n      var params = new URLSearchParams();\n      params.append(\"dept\", dept);\n      this.axios.post('api/editdept/', params).then(function (res) {\n        console.log(res);\n\n        if (res.data.code == 0) {\n          alert('恭喜您，修改部门成功！');\n\n          _this.reload();\n        } else {\n          _this.message = res.data.message;\n          alert(_this.message);\n        }\n      });\n    },\n    remove: function remove(node, data) {\n      var parent = node.parent;\n      var children = parent.data.children || parent.data;\n      var index = children.findIndex(function (d) {\n        return d.id === data.id;\n      });\n      var that = this;\n\n      if (data.label.indexOf(\"部\") != -1) {\n        var deptid = data.id;\n        var params = new URLSearchParams();\n        params.append(\"deptid\", deptid);\n        that.axios.post('api/deldept/', params).then(function (resp) {\n          if (resp.data.code == 0) {\n            alert(\"删除成功\");\n            that.reload();\n          } else {\n            that.message = resp.data.message;\n            alert(that.message);\n          }\n        });\n      } else {\n        var postid = data.id;\n\n        var _params2 = new URLSearchParams();\n\n        _params2.append(\"postid\", postid);\n\n        that.axios.post('api/delpost/', _params2).then(function (resp) {\n          if (resp.data.code == 0) {\n            alert(\"删除成功\");\n            that.reload();\n          } else {\n            that.message = resp.data.message;\n            alert(that.message);\n          }\n        });\n      }\n    },\n    handleEdit: function handleEdit(row) {\n      console.log(row.id);\n      this.$router.push({\n        name: 'editstaff',\n        params: {\n          id: row.id\n        }\n      });\n    },\n    handleDelete: function handleDelete(index, row) {\n      console.log(index, row);\n      var that = this;\n      var staffid = row.id;\n      var params = new URLSearchParams();\n      params.append(\"staffid\", staffid);\n      that.axios.post('api/delstaff/', params).then(function (resp) {\n        if (resp.data.code == 0) {\n          alert(\"删除成功\");\n          that.reload();\n        } else {\n          that.message = resp.data.message;\n          alert(that.message);\n        }\n      });\n    },\n    handleKpi: function handleKpi(row) {\n      console.log(row.id);\n      this.$router.push({\n        name: 'staffkpi',\n        params: {\n          id: row.id\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["List.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div class=\"stafflist\">\r\n\t\t\t<div class=\"staffmenu\">\r\n\t\t\t\t<h2>部门岗位</h2>\r\n\t\t\t\t<el-tree :data=\"alldeptlist\" node-key=\"id\" :expand-on-click-node=\"false\">\r\n\t\t\t\t\t<span class=\"custom-tree-node\" slot-scope=\"{ node, data }\" >\r\n\t\t\t\t\t\t<span @click=\"handleNodeClick(node, data)\">{{ node.label }}</span>\r\n\t\t\t\t        <span>\r\n\t\t\t\t\t\t\t<el-button type=\"text\" size=\"mini\" @click=\"getdeptid(node, data)\">编辑</el-button>\r\n\t\t\t\t\t\t\t<el-button type=\"text\" size=\"mini\" @click=\"remove(node, data)\">删除</el-button>\r\n\t\t\t\t        </span>\r\n\t\t\t\t    </span>\r\n\t\t\t\t</el-tree>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class=\"stafftable\" ref=\"stafftable\">\r\n\t\t\t\t<h2>成员列表</h2>\r\n\t\t\t\t<el-table :data=\"stafflist\" style=\"width: 100%\">\r\n\t\t\t\t\t<el-table-column prop=\"name\" label=\"姓名\" width=\"100\"></el-table-column>\r\n\t\t\t\t    <el-table-column prop=\"post\" label=\"岗位\" width=\"120\"></el-table-column>\r\n\t\t\t\t\t<el-table-column prop=\"dept\" label=\"部门\" width=\"100\"></el-table-column>\r\n\t\t\t\t\t<el-table-column prop=\"phone\" label=\"手机\" width=\"150\"></el-table-column>\r\n\t\t\t\t\t<el-table-column prop=\"email\" label=\"邮箱\" width=\"250\"></el-table-column>\r\n\t\t\t\t\t<el-table-column label=\"操作\" width=\"120\">\r\n\t\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t\t<el-button @click=\"handleEdit(scope.row)\" type=\"text\" size=\"small\">详细</el-button>\r\n\t\t\t\t\t\t\t<el-button @click=\"handleDelete(scope.$index, scope.row)\" type=\"text\" size=\"small\">删除</el-button>\r\n\t\t\t\t\t\t\t<el-button @click=\"handleKpi(scope.row)\" type=\"text\" size=\"small\">绩效</el-button>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-table-column>\r\n\t\t\t\t</el-table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<!--编辑部门，弹窗-->\t\t\r\n\t\t<el-dialog title=\"编辑部门\" :visible.sync=\"deptpopup\">\r\n\t\t  <el-form ref=\"form\" :model=\"form\" label-width=\"80px\">\r\n\t\t  \t<el-form-item label=\"部门名称\" class=\"deptname\">\r\n\t\t  \t\t<el-input v-model=\"form.deptname\"></el-input><span>部</span>\r\n\t\t  \t</el-form-item>\r\n\t\t  \t<el-form-item label=\"部门意义\">\r\n\t\t  \t\t<el-input type=\"textarea\" v-model=\"form.deptsense\"></el-input>\r\n\t\t  \t</el-form-item>\r\n\t\t  \t<el-form-item label=\"部门目标\">\r\n\t\t  \t\t<el-input type=\"textarea\" v-model=\"form.deptgoal\"></el-input>\r\n\t\t  \t</el-form-item>\r\n\t\t  \t<el-form-item label=\"部门职能\">\r\n\t\t  \t    <el-input type=\"textarea\" v-model=\"form.deptduty\"></el-input>\r\n\t\t  \t  </el-form-item>\r\n\t\t  </el-form>\r\n\t\t  <div slot=\"footer\" class=\"dialog-footer\">\r\n\t\t    <el-button @click=\"deptpopup = false\">取 消</el-button>\r\n\t\t    <el-button type=\"primary\" @click=\"edit()\">确 定</el-button>\r\n\t\t  </div>\r\n\t\t</el-dialog>\r\n\t\t\r\n\t</div>\r\n</template>\r\n\r\n<script>\t\r\n\texport default {\r\n\t\tinject: ['reload'],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tstafflist:[],\r\n\t\t\t\talldeptlist:[],\r\n\t\t\t\tmessage:'',\r\n\t\t\t\tform: {\r\n\t\t\t\t\tid: '',\r\n\t\t\t\t\tdeptname: '',\r\n\t\t\t\t\tdeptsense: '',\r\n\t\t\t\t\tdeptgoal: '',\r\n\t\t\t\t\tdeptduty: '',\r\n\t\t\t\t},\r\n\t\t\t\tdeptpopup:false,\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tmounted(){\r\n\t\t\tlet that = this\r\n\t\t\tvar userid = window.localStorage.getItem(\"logintoken\")\r\n\t\t\tconsole.log(userid)\r\n\t\t\t\r\n\t\t\tthat.axios.post(\"api/allstafflist/\")\r\n\t\t\t  .then(function (resp) {\r\n\t\t\t    console.log(resp.data);\r\n\t\t\t\tvar staff = resp.data;\r\n\t\t\t\tthat.stafflist = resp.data;\r\n\t\t\t  })\r\n\t\t\t  .catch(function (error) {\r\n\t\t\t    console.log(error);\r\n\t\t\t  });\r\n\t\t\t\r\n\t\t\tthat.axios.post(\"api/alldeptlist/\")\r\n\t\t\t  .then(function (resp) {\r\n\t\t\t    console.log(resp.data);\r\n\t\t\t\tvar post = JSON.stringify(resp.data)\r\n\t\t\t\tpost = post.replace(/deptname/g, \"label\")\r\n\t\t\t\tpost = post.replace(/post/g, \"children\")\r\n\t\t\t\tpost = post.replace(/childrenname/g, \"label\")\r\n\t\t\t\tpost = JSON.parse(post)\r\n\t\t\t\tthat.alldeptlist = post\r\n\t\t\t\tthat.$forceUpdate()\r\n\t\t\t  })\r\n\t\t\t  .catch(function (error) {\r\n\t\t\t    console.log(error);\r\n\t\t\t  });\r\n\t\t},\r\n\t\t\r\n\t\tmethods: {\r\n\t\t\thandleNodeClick(data) {\r\n\t\t\t\tconsole.log(data.label);\r\n\t\t\t\tconsole.log(data.id);\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tif (data.label.indexOf(\"部\") != -1) {\r\n\t\t\t\t\tlet deptid = data.id\r\n\t\t\t\t\tlet params = new URLSearchParams();\r\n\t\t\t\t\tparams.append(\"deptid\", deptid);\r\n\t\t\t\t\tthat.axios.post('api/staffdeptlist/', params)\r\n\t\t\t\t\t  .then(function (resp) {\r\n\t\t\t\t\t    console.log(resp.data);\r\n\t\t\t\t\t  \tvar staff = resp.data;\r\n\t\t\t\t\t  \tthat.stafflist = resp.data;\r\n\t\t\t\t\t  })\t\t\t\r\n\t\t\t\t}else{\r\n\t\t\t\t\tlet postid = data.id;\r\n\t\t\t\t\tlet params = new URLSearchParams();\r\n\t\t\t\t\tparams.append(\"postid\", postid);\r\n\t\t\t\t\tthat.axios.post('api/staffpostlist/', params)\r\n\t\t\t\t\t  .then(function (resp) {\r\n\t\t\t\t\t    console.log(resp.data);\r\n\t\t\t\t\t  \tvar staff = resp.data;\r\n\t\t\t\t\t  \tthat.stafflist = resp.data;\r\n\t\t\t\t\t  })\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tgetdeptid(node, data) {\r\n\t\t\t\tconst parent = node.parent;\r\n\t\t\t\tconst children = parent.data.children || parent.data;\r\n\t\t\t\tconst index = children.findIndex(d => d.id === data.id);\r\n\t\t\t\tlet postid = data.id\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tif (data.label.indexOf(\"部\") != -1) {\r\n\t\t\t\t\tthis.deptpopup = true;\r\n\t\t\t\t\tlet deptid = data.id\r\n\t\t\t\t\tlet params = new URLSearchParams();\r\n\t\t\t\t\tparams.append(\"deptid\", deptid);\r\n\t\t\t\t\tthat.axios.post('api/deptlist/', params)\r\n\t\t\t\t\t  .then(function (resp) {\r\n\t\t\t\t\t    console.log(resp.data);\r\n\t\t\t\t\t\tthat.form.id = resp.data[0].id;\r\n\t\t\t\t\t\tthat.form.deptname = resp.data[0].deptname.replace('部', '');\r\n\t\t\t\t\t\tthat.form.deptsense = resp.data[0].sense;\r\n\t\t\t\t\t\tthat.form.deptgoal = resp.data[0].goal;\r\n\t\t\t\t\t\tthat.form.deptduty = resp.data[0].duty;\r\n\t\t\t\t\t  })\r\n\t\t\t\t\t  .catch(function (error) {\r\n\t\t\t\t\t    console.log(error);\r\n\t\t\t\t\t  });\t\t\t\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.$router.push({\r\n\t\t\t\t\t\tname: 'editpost',\r\n\t\t\t\t\t\tparams: {\r\n\t\t\t\t\t\t   \tid: postid\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tedit:function(){\r\n\t\t\t\tlet data={\r\n\t\t\t\t\tid:this.form.id,\r\n\t\t\t\t\tname:this.form.deptname+'部',\r\n\t\t\t\t\tsense:this.form.deptsense,\r\n\t\t\t\t\tgoal:this.form.deptgoal,\r\n\t\t\t\t\tduty:this.form.deptduty\r\n\t\t\t\t}\r\n\t\t\t\tlet dept = JSON.stringify(data);\r\n\t\t\t\tconsole.log(dept);\r\n\t\t\t\tlet params = new URLSearchParams();\r\n\t\t\t\tparams.append(\"dept\", dept);\r\n\t\t\t\tthis.axios.post('api/editdept/', params)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tif (res.data.code == 0) {\r\n\t\t\t\t\t\talert('恭喜您，修改部门成功！');\r\n\t\t\t\t\t\tthis.reload()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.message = res.data.message\r\n\t\t\t\t\t\talert(this.message)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tremove(node, data) {\r\n\t\t\t\tconst parent = node.parent;\r\n\t\t\t\tconst children = parent.data.children || parent.data;\r\n\t\t\t\tconst index = children.findIndex(d => d.id === data.id);\r\n\t\t\t\t\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tif (data.label.indexOf(\"部\") != -1) {\r\n\t\t\t\t\tlet deptid = data.id\r\n\t\t\t\t\tlet params = new URLSearchParams();\r\n\t\t\t\t\tparams.append(\"deptid\", deptid);\r\n\t\t\t\t\tthat.axios.post('api/deldept/', params)\r\n\t\t\t\t\t  .then(function (resp) {\r\n\t\t\t\t\t    if (resp.data.code == 0) {\r\n\t\t\t\t\t\t\talert(\"删除成功\")\r\n\t\t\t\t\t\t\tthat.reload()\r\n\t\t\t\t\t    } else {\r\n\t\t\t\t\t\t\tthat.message = resp.data.message\r\n\t\t\t\t\t\t\talert(that.message)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t  })\t\t\t\r\n\t\t\t\t}else{\r\n\t\t\t\t\tlet postid = data.id;\r\n\t\t\t\t\tlet params = new URLSearchParams();\r\n\t\t\t\t\tparams.append(\"postid\", postid);\r\n\t\t\t\t\tthat.axios.post('api/delpost/', params)\r\n\t\t\t\t\t  .then(function (resp) {\r\n\t\t\t\t\t\tif (resp.data.code == 0) {\r\n\t\t\t\t\t\t\talert(\"删除成功\")\r\n\t\t\t\t\t\t\tthat.reload()\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthat.message = resp.data.message\r\n\t\t\t\t\t\t\talert(that.message)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t  })\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thandleEdit(row) {\r\n\t\t\t\tconsole.log(row.id);\r\n\t\t\t\tthis.$router.push({\r\n\t\t\t\t\tname: 'editstaff',\r\n\t\t\t\t\tparams: {\r\n\t\t\t\t\t   \tid: row.id\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\thandleDelete(index, row) {\r\n\t\t\t\tconsole.log(index, row);\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tlet staffid = row.id;\r\n\t\t\t\tlet params = new URLSearchParams();\r\n\t\t\t\tparams.append(\"staffid\", staffid);\r\n\t\t\t\tthat.axios.post('api/delstaff/', params)\r\n\t\t\t\t  .then(function (resp) {\r\n\t\t\t\t    if (resp.data.code == 0) {\r\n\t\t\t\t\t\talert(\"删除成功\")\r\n\t\t\t\t\t\tthat.reload()\r\n\t\t\t\t    } else {\r\n\t\t\t\t\t\tthat.message = resp.data.message\r\n\t\t\t\t\t\talert(that.message)\r\n\t\t\t\t\t}\r\n\t\t\t\t  })\r\n\t\t\t},\r\n\t\t\thandleKpi(row) {\r\n\t\t\t\tconsole.log(row.id)\r\n\t\t\t\tthis.$router.push({\r\n\t\t\t\t\tname: 'staffkpi',\r\n\t\t\t\t\tparams: {\r\n\t\t\t\t\t   \tid: row.id\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.stafflist{\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tjustify-content: left;\r\n\t\talign-items: stretch;\r\n\t}\r\n\t.staffmenu{\r\n\t\tbackground-color: #FCFCFC;\r\n\t\twidth: 250px;\r\n\t\tfloat: left;\r\n\t\tborder-right: 1px solid #E5E5E5;\r\n\t\theight: auto;\r\n\t}\r\n\t.stafftable{\r\n\t\tpadding:0;\r\n\t\tfloat:left;\r\n\t}\r\n\t.el-table{\r\n\t\tpadding: 10px 20px;\r\n\t}\r\n\t.el-table::before{\r\n\t\theight: 0;\r\n\t}\r\n\t.stafftable h2{\r\n\t\tmargin: 20px 0 0 30px;\r\n\t\tfont-size: 18px;\r\n\t}\r\n\r\n\t.el-tree{\r\n\t\tbackground-color: #FCFCFC;\r\n\t}\r\n\t.el-tree-node{\r\n\t\tmargin-bottom: 10px;\r\n\t}\r\n\t.el-tree-node__children .el-tree-node{\r\n\t\tmargin: 5px 0;\r\n\t}\r\n\t.el-tree-node__content{\r\n\t\tpadding-left: 20px !important;\r\n\t}\r\n\t\r\n\t.staffmenu h2{\r\n\t\tmargin: 20px 0 20px 30px;\r\n\t\tfont-size: 18px;\r\n\t}\r\n\t.custom-tree-node {\r\n\t    flex: 1;\r\n\t    display: flex;\r\n\t    align-items: center;\r\n\t    justify-content: space-between;\r\n\t    font-size: 14px;\r\n\t    padding-right: 20px;\r\n\t}\r\n</style>\r\n"],"sourceRoot":"src/pages/index/staff"}]}