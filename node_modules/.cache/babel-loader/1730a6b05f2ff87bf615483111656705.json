{"remainingRequest":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\babel-loader\\lib\\index.js!D:\\HBuilderProjects\\dmloa_pc\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\HBuilderProjects\\dmloa_pc\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\HBuilderProjects\\dmloa_pc\\src\\pages\\index\\company\\Edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\HBuilderProjects\\dmloa_pc\\src\\pages\\index\\company\\Edit.vue","mtime":1625740347641},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615258085839},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\babel-loader\\lib\\index.js","mtime":1615258097485},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615258085839},{"path":"D:\\HBuilderProjects\\dmloa_pc\\node_modules\\vue-loader\\lib\\index.js","mtime":1615258095774}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  data: function data() {\n    var _this = this;\n\n    var checkPhone = function checkPhone(rule, value, callback) {\n      if (!value) {\n        return callback(new Error('手机号码不能为空'));\n      }\n\n      setTimeout(function () {\n        if (value.length < 11) {\n          callback(new Error('手机号码不正确'));\n        } else {\n          callback();\n        }\n      }, 1000);\n    };\n\n    var validatePass = function validatePass(rule, value, callback) {\n      if (value === '') {\n        callback(new Error('请输入密码'));\n      } else {\n        if (_this.forgetForm.checkpassword !== '') {\n          _this.$refs.forgetForm.validateField('checkpassword');\n        }\n\n        callback();\n      }\n    };\n\n    var validatePass2 = function validatePass2(rule, value, callback) {\n      if (value === '') {\n        callback(new Error('请再次输入密码'));\n      } else if (value !== _this.forgetForm.password) {\n        callback(new Error('两次输入密码不一致!'));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      valiBtn: '获取验证码',\n      smscode: '',\n      //修改密码时的验证码\n      forgetForm: {\n        adminphone: '',\n        password: '',\n        checkpassword: '',\n        smscode: ''\n      },\n      rules: {\n        adminphone: [{\n          validator: checkPhone,\n          trigger: 'blur'\n        }],\n        password: [{\n          validator: validatePass,\n          trigger: 'blur'\n        }],\n        checkpassword: [{\n          validator: validatePass2,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    onReset: function onReset() {\n      var _this2 = this;\n\n      // 先验证验证码\n      if (this.forgetForm.smscode == '' || this.smscode == '' || this.smscode != this.forgetForm.smscode) {\n        alert('验证码不正确');\n      }\n\n      var userid = window.localStorage.getItem(\"logintoken\");\n      var data = {\n        id: userid,\n        phone: this.forgetForm.adminphone,\n        password: this.forgetForm.password\n      };\n      var password = JSON.stringify(data);\n      var params = new URLSearchParams();\n      params.append(\"password\", password);\n      this.$refs['forgetForm'].validate(function (valid) {\n        if (valid) {\n          _this2.axios.post('api/editpwd/', params).then(function (res) {\n            console.log(res);\n\n            if (res.data.code == 0) {\n              alert('恭喜您，修改成功！');\n            } else {\n              _this2.message = res.data.message;\n              alert(_this2.message);\n            }\n          });\n        } else {\n          console.log('error submit!!');\n        }\n      });\n    },\n    //获取修改密码短信验证码\n    getCodeForget: function getCodeForget() {\n      var _this3 = this;\n\n      this.$refs['forgetForm'].validateField('adminphone', function (err) {\n        if (err) {\n          console.log('未通过', _this3.forgetForm.adminphone);\n          return;\n        } else {\n          console.log('已通过', _this3.forgetForm.adminphone);\n          var phone = _this3.forgetForm.adminphone;\n          var staffid = window.localStorage.getItem(\"logintoken\");\n          var params = new URLSearchParams();\n          params.append(\"staffid\", staffid);\n          var that = _this3;\n          that.axios.post('api/stafflist/', params).then(function (resp) {\n            console.log(resp.data);\n\n            if (phone == resp.data[0].phone) {\n              that.tackBtn(); //验证码倒数60秒\t\n\n              var myurl = 'api/smscode/' + phone + \"/\";\n              that.axios.get(myurl).then(function (res) {\n                console.log('服务端生成的验证码', res.data);\n                that.smscode = res.data;\n              });\n            } else {\n              alert('手机号码与注册时的号码不一致，请重新输入！');\n            }\n          }).catch(function (error) {\n            console.log(error);\n          });\n        }\n      });\n    },\n    //验证码倒数60秒\n    tackBtn: function tackBtn() {\n      var _this4 = this;\n\n      var time = 60;\n      var timer = setInterval(function () {\n        if (time == 0) {\n          clearInterval(timer);\n          _this4.valiBtn = '获取验证码';\n          _this4.disabled = false;\n        } else {\n          _this4.disabled = true;\n          _this4.valiBtn = time + '秒后重试';\n          time--;\n        }\n      }, 1000);\n    }\n  }\n};",{"version":3,"sources":["Edit.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<el-form :model=\"forgetForm\" :rules=\"rules\" ref=\"forgetForm\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n\t\t\t<el-form-item label=\"管理员手机\" prop=\"adminphone\">\r\n\t\t\t\t<el-input v-model=\"forgetForm.adminphone\"></el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item label=\"短信验证码\" prop=\"smscode\" class=\"verification\">\r\n\t\t\t\t<el-input v-model=\"forgetForm.smscode\"></el-input>\r\n\t\t\t\t<el-button @click=\"getCodeForget\">{{valiBtn}}</el-button>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item label=\"登录密码\" prop=\"password\">\r\n\t\t\t\t<el-input type=\"password\" v-model=\"forgetForm.password\" autocomplete=\"off\"></el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item label=\"确认密码\" prop=\"checkpassword\">\r\n\t\t\t\t<el-input type=\"password\" v-model=\"forgetForm.checkpassword\" autocomplete=\"off\"></el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"onReset('forgetForm')\">重置</el-button>\r\n\t\t\t</el-form-item>\r\n\t\t</el-form>\r\n\t</div>\n</template>\n\n<script>\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\tvar checkPhone = (rule, value, callback) => {\r\n\t\t\t\tif (!value) {\r\n\t\t\t\t\treturn callback(new Error('手机号码不能为空'));\r\n\t\t\t\t}\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tif (value.length < 11) {\r\n\t\t\t\t\t\tcallback(new Error('手机号码不正确'));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1000);\r\n\t\t\t};\r\n\t\t\tvar validatePass = (rule, value, callback) => {\r\n\t\t\t\tif (value === '') {\r\n\t\t\t\t\tcallback(new Error('请输入密码'));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (this.forgetForm.checkpassword !== '') {\r\n\t\t\t\t\t\tthis.$refs.forgetForm.validateField('checkpassword');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcallback();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar validatePass2 = (rule, value, callback) => {\r\n\t\t\t\tif (value === '') {\r\n\t\t\t\t\tcallback(new Error('请再次输入密码'));\r\n\t\t\t\t} else if (value !== this.forgetForm.password) {\r\n\t\t\t\t\tcallback(new Error('两次输入密码不一致!'));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\treturn {\r\n\t\t\t\tvaliBtn:'获取验证码',\r\n\t\t\t\tsmscode: '', //修改密码时的验证码\r\n\t\t\t\tforgetForm: {\r\n\t\t\t\t\tadminphone: '',\r\n\t\t\t\t\tpassword: '',\r\n\t\t\t\t\tcheckpassword: '',\r\n\t\t\t\t\tsmscode: ''\r\n\t\t\t\t},\r\n\t\t\t\trules: {\r\n\t\t\t\t\tadminphone: [{validator: checkPhone,trigger: 'blur'}],\r\n\t\t\t\t\tpassword: [{validator: validatePass,trigger: 'blur'}],\r\n\t\t\t\t\tcheckpassword: [{validator: validatePass2,trigger: 'blur'}]\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tonReset: function() {\r\n\t\t\t\t// 先验证验证码\r\n\t\t\t\tif (this.forgetForm.smscode == '' || this.smscode == '' || this.smscode != this.forgetForm.smscode) {\r\n\t\t\t\t\talert('验证码不正确');\r\n\t\t\t\t}\r\n\t\t\t\tvar userid = window.localStorage.getItem(\"logintoken\")\r\n\t\t\t\tlet data={\r\n\t\t\t\t\tid:userid,\r\n\t\t\t\t\tphone:this.forgetForm.adminphone,\r\n\t\t\t\t\tpassword:this.forgetForm.password,\r\n\t\t\t\t}\r\n\t\t\t\tlet password = JSON.stringify(data);\r\n\t\t\t\tlet params = new URLSearchParams();\r\n\t\t\t\tparams.append(\"password\", password);\r\n\t\t\t\tthis.$refs['forgetForm'].validate((valid) => {\r\n\t\t\t\t    if (valid) {\r\n\t\t\t\t\t\tthis.axios.post('api/editpwd/', params)\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t\tif (res.data.code == 0) {\r\n\t\t\t\t\t\t\t\talert('恭喜您，修改成功！');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.message = res.data.message\r\n\t\t\t\t\t\t\t\talert(this.message)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t    } else {\r\n\t\t\t\t\t\tconsole.log('error submit!!');\r\n\t\t\t\t    }\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t//获取修改密码短信验证码\r\n\t\t\tgetCodeForget(){\r\n\t\t\t   this.$refs['forgetForm'].validateField('adminphone', (err) =>{\r\n\t\t\t        if(err){\r\n\t\t\t            console.log('未通过', this.forgetForm.adminphone)\r\n\t\t\t            return;\r\n\t\t\t        }else{\r\n\t\t\t            console.log('已通过', this.forgetForm.adminphone)\r\n\t\t\t\t\t\tlet phone = this.forgetForm.adminphone\r\n\t\t\t\t\t\tlet staffid = window.localStorage.getItem(\"logintoken\")\r\n\t\t\t\t\t\tlet params = new URLSearchParams();\r\n\t\t\t\t\t\tparams.append(\"staffid\", staffid);\r\n\t\t\t\t\t\tlet that = this;\r\n\t\t\t\t\t\tthat.axios.post('api/stafflist/', params)\r\n\t\t\t\t\t\t  .then(function (resp) {\r\n\t\t\t\t\t\t\t  console.log(resp.data);\r\n\t\t\t\t\t\t\t  if(phone == resp.data[0].phone){\r\n\t\t\t\t\t\t\t\t  that.tackBtn(); //验证码倒数60秒\t\r\n\t\t\t\t\t\t\t\t  let myurl = 'api/smscode/' + phone + \"/\"\r\n\t\t\t\t\t\t\t\t  that.axios.get(myurl)\r\n\t\t\t\t\t\t\t\t  .then(res => {\r\n\t\t\t\t\t\t\t\t  \tconsole.log('服务端生成的验证码', res.data) \r\n\t\t\t\t\t\t\t\t  \tthat.smscode = res.data\r\n\t\t\t\t\t\t\t\t  })\r\n\t\t\t\t\t\t\t  }else{\r\n\t\t\t\t\t\t\t\t  alert('手机号码与注册时的号码不一致，请重新输入！')\r\n\t\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t  })\r\n\t\t\t\t\t\t  .catch(function (error) {\r\n\t\t\t\t\t\t\t  console.log(error);\r\n\t\t\t\t\t\t  });\r\n\t\t\t        }\r\n\t\t\t    })\r\n\t\t\t},\r\n\t\t\t//验证码倒数60秒\r\n\t\t\ttackBtn(){       \r\n\t\t\t\tlet time = 60;\r\n\t\t\t\tlet timer = setInterval(() => {\r\n\t\t\t\t\tif(time == 0){\r\n\t\t\t\t\t\tclearInterval(timer);\r\n\t\t\t\t\t\tthis.valiBtn = '获取验证码';\r\n\t\t\t\t\t\tthis.disabled = false;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.disabled = true;\r\n\t\t\t\t\t\tthis.valiBtn = time + '秒后重试';\r\n\t\t\t\t\t\ttime--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1000);\r\n\t\t\t},\r\n\t\t}\r\n\t}\n</script>\n\n<style>\r\n\t.verification .el-input{\r\n\t\twidth:138px;\r\n\t\tmargin-right: 10px;\r\n\t}\n</style>\n"],"sourceRoot":"src/pages/index/company"}]}